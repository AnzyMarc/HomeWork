# Домашнее задание по Ansible: Автоматизация конфигурации серверов

В данном репозитории представлены решения трех задач по настройке управляемых узлов с использованием Ansible.

---

## Задание 1: Базовая автоматизация (`task1.yml`)

Этот сценарий выполняет начальную настройку системного окружения и установку необходимого ПО.

* **Архив (1.1):** Использование модуля `unarchive` для развертывания **Apache Kafka**. Благодаря параметру `remote_src: yes`, скачивание дистрибутива происходит напрямую на целевой сервер, что экономит трафик контроллера.
* **Пакет Tuned (1.2):** Установка и активация сервиса `tuned` для динамической оптимизации системы. Модуль `service` гарантирует состояние `started` и автозагрузку `enabled`.
* **Приветствие (1.3):** Создание статического файла `/etc/motd` с приветствием.

### Результат выполнения Задания 1
![Выполнение task1.yml](./screenshots/Task1Запуск.png)


### Проверка состояния системы
Для подтверждения корректности установки были выполнены следующие проверки:

1. **Список файлов Kafka:**
\`\`\`bash
ansible all -a "ls -l /tmp/kafka_extracted" -i inventory.ini
\`\`\`
![Проверка Kafka](./screenshots/kafka_test.png)

2. **Статус сервиса Tuned:**
\`\`\`bash
ansible all -a "systemctl status tuned" -i inventory.ini
\`\`\`
![Статус Tuned](./screenshots/tuned_test.png)

## Задание 2: Динамическое приветствие (`task1.yml`)

В этой части статическое приветствие заменено на динамическое с использованием системных фактов (**Ansible Facts**).

**Суть изменений:**
Плейбук собирает информацию о хосте и подставляет её в файл `/etc/motd`:
* `{{ ansible_hostname }}` — сетевое имя сервера.
* `{{ ansible_default_ipv4.address }}` — IP-адрес управления.

### Проверка динамического приветствия

![Скриншот MOTD](./screenshots/terminal_out.png)   


## Задание 3: Роли и шаблоны (`site.yml`)

Этот плейбук является мастер-файлом, который настраивает веб-сервер Apache с использованием модульного подхода и динамических шаблонов.

* **Роль `apache_info`**: Инкапсулирует всю логику установки Apache2, конфигурации и управления службой.
* **Шаблон Jinja2**: Файл `index.html` формируется динамически на основе системных характеристик каждого хоста (модель CPU, объем RAM и свободное место на диске).
* **Handlers**: Реализован механизм автоматического перезапуска Apache при обновлении шаблона.



2. **Проверка HTTP-статуса (Smoke Test):**
\`\`\`bash
ansible-playbook -i inventory.ini site.yml
\`\`\`

![Скриншот выполнения site.yml](./screenshots/site_out.png)

### Финальный результат в браузере
При переходе по публичному IP адресу любого из серверов отображается страница с его техническими характеристиками:
![Скриншот страницы Apache](./screenshots/web_out.png)